<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste Simples TTS</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
            background: #f0f0f0;
        }
        button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background: #45a049;
        }
        .log {
            background: white;
            border: 1px solid #ddd;
            padding: 10px;
            margin: 20px 0;
            border-radius: 4px;
            max-height: 300px;
            overflow-y: auto;
        }
        .log div {
            margin: 5px 0;
            padding: 5px;
            background: #f9f9f9;
            border-left: 3px solid #4CAF50;
        }
        .error {
            border-left-color: #f44336 !important;
            background: #ffe5e5 !important;
        }
    </style>
</head>
<body>
    <h1>Teste Simples de TTS</h1>
    
    <button onclick="testBasicTTS()">Teste Básico</button>
    <button onclick="testWithVoice()">Teste com Voz PT-BR</button>
    <button onclick="listVoices()">Listar Vozes</button>
    <button onclick="clearLog()">Limpar Log</button>
    
    <div class="log" id="log"></div>
    
    <script>
        const log = document.getElementById('log');
        
        function addLog(message, isError = false) {
            const div = document.createElement('div');
            div.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            if (isError) div.classList.add('error');
            log.appendChild(div);
            log.scrollTop = log.scrollHeight;
            console.log(message);
        }
        
        // Teste 1: TTS básico
        function testBasicTTS() {
            addLog('Iniciando teste básico de TTS...');
            
            if (!window.speechSynthesis) {
                addLog('Speech Synthesis não está disponível!', true);
                return;
            }
            
            const utterance = new SpeechSynthesisUtterance('Olá! Este é um teste básico de síntese de voz.');
            utterance.lang = 'pt-BR';
            
            utterance.onstart = () => addLog('Começou a falar');
            utterance.onend = () => addLog('Terminou de falar');
            utterance.onerror = (e) => addLog(`Erro: ${e.error}`, true);
            
            // Cancelar qualquer fala anterior
            speechSynthesis.cancel();
            
            // Falar
            speechSynthesis.speak(utterance);
            addLog('Comando de fala enviado');
        }
        
        // Teste 2: TTS com voz específica
        function testWithVoice() {
            addLog('Iniciando teste com voz PT-BR...');
            
            const voices = speechSynthesis.getVoices();
            const ptBRVoice = voices.find(v => v.lang.includes('pt-BR'));
            
            if (!ptBRVoice) {
                addLog('Nenhuma voz PT-BR encontrada!', true);
                return;
            }
            
            addLog(`Usando voz: ${ptBRVoice.name}`);
            
            const utterance = new SpeechSynthesisUtterance('Testando com voz em português brasileiro específica.');
            utterance.voice = ptBRVoice;
            utterance.lang = 'pt-BR';
            
            utterance.onstart = () => addLog('Começou a falar com voz específica');
            utterance.onend = () => addLog('Terminou de falar com voz específica');
            utterance.onerror = (e) => addLog(`Erro: ${e.error}`, true);
            
            speechSynthesis.cancel();
            speechSynthesis.speak(utterance);
        }
        
        // Listar vozes disponíveis
        function listVoices() {
            addLog('Listando vozes disponíveis...');
            const voices = speechSynthesis.getVoices();
            
            if (voices.length === 0) {
                addLog('Nenhuma voz disponível ainda', true);
                return;
            }
            
            addLog(`Total de vozes: ${voices.length}`);
            voices.forEach((voice, i) => {
                if (voice.lang.includes('pt')) {
                    addLog(`${i}: ${voice.name} (${voice.lang}) ${voice.default ? '[PADRÃO]' : ''}`);
                }
            });
        }
        
        function clearLog() {
            log.innerHTML = '';
            addLog('Log limpo');
        }
        
        // Verificar disponibilidade ao carregar
        window.addEventListener('load', () => {
            addLog('Página carregada');
            addLog(`Speech Synthesis disponível: ${!!window.speechSynthesis}`);
            
            // Tentar carregar vozes
            if (window.speechSynthesis) {
                speechSynthesis.getVoices();
                
                // Evento quando vozes são carregadas
                speechSynthesis.onvoiceschanged = () => {
                    addLog('Evento voiceschanged disparado');
                    const voices = speechSynthesis.getVoices();
                    addLog(`Vozes carregadas: ${voices.length}`);
                };
            }
        });
    </script>
</body>
</html>